import React, { useState, useEffect } from 'react';

import ContainerGraphics from '../../components/ContainerGraphics';
import ContainerHeaderDashBoard from '../../components/ContainerHeaderDashBoard';

import {FaUserFriends,FaUserShield} from 'react-icons/fa';
import {TiWarning} from 'react-icons/ti';
import {BiTargetLock} from 'react-icons/bi';
import {RiSkullFill} from 'react-icons/ri';

import api from '../../services/api';

import './styles.css';

const DashBoard = () => {
    const [totalHosts, setTotalHosts] = useState(0)
    const [vulnerableHosts, setVulnerableHosts] = useState(0)
    const [totalVulnerabilities, setTotalVulnerabilities] = useState(0)
    const [unpatchedVulnerabilities, setUnpatchedVulnerabilities] = useState(0)

    useEffect(() => {
        api.get('/api/dashboard/cards/asset').then(response => {
            console.log(response.data)
            setTotalHosts(response.data.asset_count)
            setVulnerableHosts(response.data.vulnerable_asset_count)
        })
    }, [])

    useEffect(() => {

        api.get('/api/dashboard/cards/vulnerability').then(response => {
            setTotalVulnerabilities(response.data.vuln_count)
            setUnpatchedVulnerabilities(response.data.active_vuln_count)
        })
    }, [])

    return(
        <div className = 'dashboard-container'>
               <nav>
                   <ContainerHeaderDashBoard>
                       <fieldset>
                          
                            <p>Total de hosts</p>
                            
                            <div className = 'group-data'>
                                    <FaUserFriends size = '35' color = '#2a2a2a'/>
                                    
                                    <strong>{totalHosts}</strong>
                            </div>

                            <p>Hosts vulneráveis</p>

                            <div className = 'group-data'>
                                    <FaUserShield size = '35' color = '#cc3333'/>
                                    <strong style = {{color: '#cc3333'}}>{vulnerableHosts}</strong>
                            </div>
                       </fieldset>
                      
                   </ContainerHeaderDashBoard>

                   <ContainerHeaderDashBoard >
                    <fieldset>
                            
                            <p>Total de vulnerabilidades</p>
                            
                            <div className = 'group-data'>
                                    <BiTargetLock size = '35' color = '#6600ff'/>
                                    
                                    <strong style = {{color: '#6600ff'}}>{totalVulnerabilities}</strong>
                            </div>

                            <p>Vulnerabilidades ativas</p>

                            <div className = 'group-data'>
                                    <TiWarning size = '35' color = '#ff6600'/>
                                    <strong style = {{color: '#ff6600'}}>{unpatchedVulnerabilities}</strong>
                            </div>
                        </fieldset>
                   </ContainerHeaderDashBoard>

                   <ContainerHeaderDashBoard>
                        <fieldset>
                            
                            <p>Média de risco dos hosts</p>
                            
                            <div className = 'group-data'>
                                    <RiSkullFill size = '35' color = '#ff6600'/>
                                    <strong style = {{color: '#ff6600'}}>{totalVulnerabilities}</strong>
                            </div>

                        </fieldset>
                   </ContainerHeaderDashBoard>

               </nav>

               <main>
                   <ContainerGraphics />
                   <ContainerGraphics />
               </main>
        </div>
    )
}

export default DashBoard;