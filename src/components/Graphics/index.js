import Highcharts from 'highcharts';
import api from '../../services/api';

class Graphics{

    async Top10HostsMoreVulnerables(){
        //Listagem com os 10 hosts mais vulneráveis
        try{
            const response = await api.get('/api/dashboard/charts/top-assets')
        
            const arrayHosts = response.data.map(data => {
                return data.host
            })
    
            const arrayVulnCount = response.data.map(data => {
                return data.vuln_count
            })
    
            Highcharts.chart('graphicHosts' ,{
            
                colors: ['#cc3333'],
    
                chart: {
                    type: 'bar'
                },
    
                title: {
                    text: 'Top 10 Hosts more vulnerables',
                    
                },
                xAxis: {
                    categories: arrayHosts,
                },
                
                series: [{
                    name: 'Vulnerabilities',
                    data: arrayVulnCount
                }]
            });
            
        }catch(err){
            return err
        }
       
    }

    async vulnerabilitiesUnpatchedBySeverity(){
        try{
            const response = await api.get('/api/dashboard/charts/severity')

            const {Baixo, Médio, Alto, Crítico} = response.data;

            Highcharts.chart('graphicVulnerabilities' ,{
                colors: ['#ff6600'],
                chart: {
                    type: 'bar'
                },
                title: {
                    text: 'Vulnerabilities uncorrected by severity'
                },
                xAxis: {
                    categories: ['Low', 'Middle', 'High', 'Critical'],

                },

                series: [{
                    name: 'Severity',
                    data: [Baixo, Médio, Alto, Crítico]
                }]
            });

        }catch(err){
            return err
        }
        
    }

}

export default Graphics