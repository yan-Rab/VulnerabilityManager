import Highcharts from 'highcharts';
import api from '../../services/api';

class Graphics{

    async Top10HostsMoreVulnerables(){
        //Listagem com os 10 hosts mais vulneráveis
        const response = await api.get('http://167.114.135.109/api/dashboard/charts/top-assets')
        
        const arrayHosts = response.data.map(data => {
            return data.host
        })

        const arrayVulnCount = response.data.map(data => {
            return data.vuln_count
        })

        Highcharts.chart('graphicHosts' ,{
        
            colors: ['#cc3333'],

            chart: {
                type: 'bar'
            },

            title: {
                text: 'Top 10 Hosts more vulnerables',
                
            },
            xAxis: {
                categories: arrayHosts,
            },
            
            series: [{
                name: 'Vulnerabilities',
                data: arrayVulnCount
            }]
        });
    }

    async vulnerabilitiesUnpatchedBySeverity(){

        const response = await api.get('http://167.114.135.109/api/dashboard/charts/severity')

        const {Baixo, Médio, Alto, Crítico} = response.data;

        Highcharts.chart('graphicVulnerabilities' ,{
            colors: ['#ff6600'],
            chart: {
                type: 'bar'
            },
            title: {
                text: 'Vulnerabilities uncorrected by severity'
            },
            xAxis: {
                categories: ['Low', 'Middle', 'High', 'Critical'],

            },

            series: [{
                name: 'Severity',
                data: [Baixo, Médio, Alto, Crítico]
            }]
        });
    }

}

export default Graphics